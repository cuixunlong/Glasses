(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/detail"],{"460d":function(e,t,a){"use strict";a.r(t);var i=a("ed93"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t["default"]=s.a},"63c3":function(e,t,a){"use strict";(function(e,t){var i=a("47a9");a("d3e5");i(a("3240"));var s=i(a("bb2e"));e.__webpack_require_UNI_MP_PLUGIN__=a,t(s.default)}).call(this,a("3223")["default"],a("df3c")["createPage"])},"7e61":function(e,t,a){"use strict";var i=a("99bd"),s=a.n(i);s.a},"99bd":function(e,t,a){},bb2e:function(e,t,a){"use strict";a.r(t);var i=a("d124"),s=a("460d");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("7e61");var o=a("828b"),r=Object(o["a"])(s["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);t["default"]=r.exports},d124:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return i}));var i={uModal:function(){return a.e("uview-ui/components/u-modal/u-modal").then(a.bind(null,"eabe"))},uToast:function(){return a.e("uview-ui/components/u-toast/u-toast").then(a.bind(null,"b3f5"))},uParse:function(){return Promise.all([a.e("common/vendor"),a.e("uview-ui/components/u-parse/u-parse")]).then(a.bind(null,"3655"))},uPopup:function(){return a.e("uview-ui/components/u-popup/u-popup").then(a.bind(null,"bba6"))},uSelect:function(){return a.e("uview-ui/components/u-select/u-select").then(a.bind(null,"4710"))},uInput:function(){return Promise.all([a.e("common/vendor"),a.e("uview-ui/components/u-input/u-input")]).then(a.bind(null,"662d"))}},s=function(){var e=this,t=e.$createElement,a=(e._self._c,e.flavorList.length),i=e.partsList.length;e._isMounted||(e.e0=function(t){e.show=!0},e.e1=function(t){e.show=!1}),e.$mp.data=Object.assign({},{$root:{g0:a,g1:i}})},n=[]},ed93:function(e,t,a){"use strict";(function(e,i){var s=a("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(a("7ca3")),o={data:function(){var e;return e={swiperHeight:"",sureShow:!1,show:!1,partsShow:!1,candleNum:"",platePrice:0,changePlate:"",plate:"",plateNum:"",plateIndex:0,plateShow:!1,plateList:[],flavorIndex:0,flavorPrice:"",flavorName:"",sizeIndex:0,sizePrice:"",sizeName:"",partsIndex:0,partsPrice:"",partsName:"",navBarHeight:0,blessing:"",swiper:["../../static/details/top_food.png","../../static/details/top_food.png","../../static/details/top_food.png","../../static/details/top_food.png","../../static/details/top_food.png"],sizeList:[],partsList:[],flavorList:[],goodsDetail:[]},(0,n.default)(e,"plateList",[]),(0,n.default)(e,"list",[]),(0,n.default)(e,"defalt",[0]),(0,n.default)(e,"from",{}),(0,n.default)(e,"swiperList",[]),(0,n.default)(e,"number",""),(0,n.default)(e,"stock",""),e},onLoad:function(t){var a=this;this.stock=t.stock;var s=e.getSystemInfoSync();this.swiperHeight=s.screenWidth;var n=e.getMenuButtonBoundingClientRect();this.navBarHeight=2*(n.top-s.statusBarHeight)+s.statusBarHeight;for(var o=1;o<=100;o++){var r={};r.value=o,r.label=o+"岁",this.list.push(r)}this.$u.post("/index/getGoodsDetail",{goods_id:t.goods_id}).then((function(e){0==e.error?(a.from.goods_id=e.data.goods_id,a.from.goods_sku_id=e.data.sku[a.partsIndex].id,void 0!=e.data.candle_select[a.partsIndex]&&(a.from.candle_select=e.data.candle_select[a.partsIndex].candle_name,a.from.candle_select=e.data.candle_select[a.partsIndex].id),void 0!=e.data.taste_select[a.flavorIndex]&&(a.from.taste_select=e.data.taste_select[a.flavorIndex].id),a.from.tableware_num="",a.goodsDetail=e.data,a.swiperList=e.data.album.split(","),""!=e.data.taste_select&&(a.flavorList=e.data.taste_select,a.flavorPrice=e.data.taste_select[a.flavorIndex].price,a.flavorName=e.data.taste_select[a.flavorIndex].name),""!=e.data.candle_select&&(a.partsList=e.data.candle_select,a.partsPrice=e.data.candle_select[a.partsIndex].price,a.partsName=e.data.candle_select[a.partsIndex].name),a.sizeList=e.data.sku,console.log(a.stock),1==a.stock&&(a.sizeIndex=a.sizeList.findIndex((function(e){return e.specs_stock>0}))),a.sizePrice=e.data.sku[a.sizeIndex].specs_price,a.sizeName=e.data.sku[a.sizeIndex].specs_name,a.number=+e.data.tableware_num,a.plate=e.data.tableware_price,a.changePlate=2*+e.data.tableware_price,a.totalPrice()):i.showToast({title:e.msg,icon:"none"});for(var t=1;t<=30;t++){var s={};a.plateNum=a.goodsDetail.tableware_num,a.plate=a.goodsDetail.tableware_price,s.value=t,s.label="餐盘数量"+t*a.plateNum+"个（"+(t*a.plateNum-a.plate)+"元）",a.plateList.push(s)}console.log(a.plateList)}))},methods:{confirm:function(){i.reLaunch({url:"../login/login"}),this.sureShow=!1},cancel:function(){this.sureShow=!1},changeFlavor:function(e,t){console.log(e),this.from.taste_select=e.id,this.flavorPrice=e.price,this.flavorName=e.name,this.totalPrice(),this.flavorIndex=t},chooseSize:function(e,t){this.from.goods_sku_id=t.id,1!=this.stock?(this.sizePrice=t.specs_price,this.sizeName=t.specs_name,this.totalPrice(),this.sizeIndex=e):0==t.specs_stock?i.showToast({title:"当前门店该尺寸库存已售罄",icon:"none"}):(this.sizePrice=t.specs_price,this.sizeName=t.specs_name,this.totalPrice(),this.sizeIndex=e)},changeColor:function(e,t){console.log(t),1==t.is_default&&(this.partsShow=!0),this.from.candle_select=t.id,this.partsPrice=t.price,this.partsName=t.name,this.totalPrice(),1==t.candle_num&&(this.partsShow=!0),this.partsIndex=e},changeCandle:function(e){this.defalt=[e[0].label-1],console.log(e),this.from.candle_num=e[0].value,console.log(this.from.candle_num)},cancelCandle:function(){this.candleNum=this.candleNum,console.log(this.candleNum)},choosePlate:function(e){this.from.tableware_num=e[0].value*this.plateNum,this.from.tableware_num=this.from.tableware_num;var t=(this.from.tableware_num-this.plateNum)/this.plateNum*this.plate;this.goodsDetail.price=this.keepFull(+this.goodsDetail.price+t)},value:function(){this.blessing.length>=20?i.showToast({title:"最多输入20个字",duration:2e3,icon:"none"}):this.from.wish_remark=this.blessing},sureBtn:function(){this.$u.throttle(this.sure,1e3)},sure:function(){var e=this;console.log(this.from.tableware_num),""===i.getStorageSync("token")?this.sureShow=!0:0==i.getStorageSync("is_bind")&&i.clearStorageSync(),""==this.sizePrice?i.showToast({title:"当前门店库存已售罄",icon:"none"}):""==this.blessing?i.showToast({title:"请输入祝福语",icon:"none"}):""==this.from.tableware_num?(i.showToast({title:"请选择餐盘数量",icon:"none"}),this.plateShow=!this.plateShow):this.$u.post("/order/previewOrder",this.from).then((function(t){0==t.error?(i.setStorageSync("order_key",e.from),i.navigateTo({url:"../order/confirm_order?stock="+e.stock})):"数字蜡烛,需要您选择年龄"==t.msg?(e.partsShow=!0,i.showToast({title:t.msg,icon:"none"})):i.showToast({title:t.msg,icon:"none"})}))},swiperPreview:function(e){i.previewImage({urls:this.swiperList,current:e})},totalPrice:function(){console.log(this.sizePrice),""==this.sizePrice?this.goodsDetail.price=+ +this.flavorPrice+ +this.partsPrice+ +this.platePrice:this.goodsDetail.price=+this.sizePrice+ +this.flavorPrice+ +this.partsPrice+ +this.platePrice,this.goodsDetail.price=this.keepFull(this.goodsDetail.price)},keepFull:function(e){var t=Math.round(100*e)/100,a=t.toString(),i=a.indexOf(".");i<0&&(i=a.length,a+=".");while(a.length<=i+2)a+="0";return a}}};t.default=o}).call(this,a("3223")["default"],a("df3c")["default"])}},[["63c3","common/runtime","common/vendor"]]]);
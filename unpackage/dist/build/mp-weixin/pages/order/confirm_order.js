(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/confirm_order"],{"47d8":function(e,o,n){"use strict";n.d(o,"b",(function(){return t})),n.d(o,"c",(function(){return i})),n.d(o,"a",(function(){return r}));var r={uSelect:function(){return n.e("uview-ui/components/u-select/u-select").then(n.bind(null,"4710"))},uIcon:function(){return n.e("uview-ui/components/u-icon/u-icon").then(n.bind(null,"84d6"))}},t=function(){var e=this.$createElement,o=(this._self._c,this.orderInfo.address.length);this.$mp.data=Object.assign({},{$root:{g0:o}})},i=[]},"727b":function(e,o,n){"use strict";(function(e){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n={data:function(){return{show:!1,timeShow:!1,sendShow:!1,checked:"",arriveDay:"",sendTime:"选择预约配送时间",coupon:"",couponNum:"",invoice:"不开发票",remark:"选填，可填写特殊需求等",number:1,defaultTime:[0,0],defaultInvoice:[0],orderInfo:{goods:{logo:"../../static/details/glasses1.jpg",name:"BOLON暴龙眼镜框商务休闲眉框合金光学镜架BJ7130",price:"999"},address:{contacts:"张三",contacts_phone:"1368678867877",address:"安徽省合肥市长丰县"},Allprice:"999"},from:{},stock:"",list:[{value:"0",label:"不开发票"},{value:"1",label:"开发票"}],timeList:[]}},onLoad:function(o){console.log(o.stock),"undefined"!=o.stock&&(this.stock=o.stock),console.log(this.stock);if(1==o.stock){var n=new Date,r=n.getFullYear(),t=n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1,i=n.getDate()<10?"0"+n.getDate():n.getDate(),a=r+"-"+t+"-"+i;this.sendTime="立即送出",this.arriveDay=a,console.log(this.timeList)}for(var l=new Date,c=l.getTime(),s={},d=0;d<30;d++){var u=c+864e5*d,f=new Date(u),h=(r=f.getFullYear(),f.getMonth()+1<10?"0"+(f.getMonth()+1):f.getMonth()+1),m=(n=f.getDate()<10?"0"+(f.getDate()+1):f.getDate()+1,r+"-"+h+"-"+n);"日一二三四五六".charAt(f.getDay());s[d]={},s[d].label="",s[d].value=d,s[d].label=m,this.timeList[0]=s}var v=[],p=[];for(d=0;d<12;d++){v[d]={},p[d]={},p[d].label="",v[d].label="",v[d].label+=7+2*d>24?7+2*d-24:7+2*d,v[d].label=(v[d].label<10?"0"+v[d].label:v[d].label)+":00";var g=d+1,_=d;p[d].label+=7+2*g>24?7+2*g-24:7+2*g,p[d].label=(p[_].label<10?"0"+p[_].label:p[_].label)+":00",v[d].label+="-"+p[d].label,v[d].value=d}this.timeList[1]=v;e.getStorageSync("order_key")},onShow:function(){var o=this;""!=e.getStorageSync("remarks")?(this.remark=e.getStorageSync("remarks"),this.from.remark=this.remark):(this.remark="选填，可填写特殊需求等",this.from.remark=""),e.$on("address_id",(function(n){o.from.address_id=n.address_id,""!=n.address_id&&o.$u.post("/ucenter/getUserRegions").then((function(e){0==e.error&&(o.orderInfo.address=e.data.items.filter((function(e){return e.address_id==n.address_id})),o.orderInfo.address=o.orderInfo.address[0])})),e.$off("address_id")})),e.$on("invoice_id",(function(n){console.log(n),o.from.is_invoice=n.invoice_id,e.$off("invoice_id")})),e.$on("m_coupon_id",(function(n){o.from.coupon_id=n.m_coupon_id,o.from.use_voucher=0;var r=e.getStorageSync("order_key");o.$u.post("/order/previewOrder",r).then((function(e){if(0==e.error){console.log("id"),o.orderInfo.Allprice=e.data.Allprice;var r=e.data.CouponList.filter((function(e){return n.m_coupon_id==e.m_coupon_id}));o.checked=!1,o.coupon=-r[0].coupon_money,o.coupon=o.keepFull(o.coupon),o.orderInfo.Allprice=+o.orderInfo.Allprice+ +o.coupon,o.orderInfo.Allprice=o.keepFull(o.orderInfo.Allprice),o.orderInfo.Allprice<=0&&(o.orderInfo.Allprice=.01)}})),e.$off("coupon_id")}))},methods:{confirm:function(o){console.log(o[0].value),this.defaultInvoice=[o[0].value],this.invoice=o[0].label,1==o[0].value&&e.navigateTo({url:"../index/invoice/invoice?id=1"})},keepFull:function(e){var o=Math.round(100*e)/100,n=o.toString(),r=n.indexOf(".");r<0&&(r=n.length,n+=".");while(n.length<=r+2)n+="0";return n},chooseInvoice:function(){this.show=!0},toRemarks:function(){e.navigateTo({url:"remarks"})},cardCheck:function(){var o=this;this.checked=!this.checked;var n=e.getStorageSync("order_key");this.$u.post("/order/previewOrder",n).then((function(e){if(0==e.error){o.orderInfo=e.data,console.log(o.orderInfo.Allprice);var n=parseFloat(o.orderInfo.Allprice),r=parseFloat(o.orderInfo.discount_money);1==o.checked?(n=+(n-r).toFixed(2),o.from.coupon_id="",o.from.use_voucher=r,1==isFinite(o.coupon)&&(o.coupon="")):o.from.use_voucher=0,o.orderInfo.Allprice=n,o.orderInfo.Allprice=o.keepFull(o.orderInfo.Allprice)}}))},toCoupon:function(){e.navigateTo({url:"usCoupon"})},toAddress:function(){e.navigateTo({url:"../user_info/address/address?id=1"})},sendConfirm:function(e){this.arriveDay=e[0].label,this.sendTime=e[1].label;var o=this.sendTime.slice(6,11);console.log(o),this.from.need_time=this.arriveDay+"-"+o,console.log(this.from.need_time),this.defaultTime=[e[0].value,e[1].value]},openSennd:function(){"立即送出"!=this.sendTime&&(this.sendShow=!0)},toPay:function(){e.navigateTo({url:"payment?order_id="})},pay:function(){this.$u.post("/order/createOrder",this.from).then((function(o){0==o.error?e.navigateTo({url:"payment?order_id="+o.data}):e.showToast({title:o.msg,icon:"none"})}))}},onUnload:function(){e.removeStorageSync("remarks")}};o.default=n}).call(this,n("df3c")["default"])},a2ee:function(e,o,n){},b7fe:function(e,o,n){"use strict";(function(e,o){var r=n("47a9");n("d3e5");r(n("3240"));var t=r(n("f9a6"));e.__webpack_require_UNI_MP_PLUGIN__=n,o(t.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},e927:function(e,o,n){"use strict";var r=n("a2ee"),t=n.n(r);t.a},ed3f:function(e,o,n){"use strict";n.r(o);var r=n("727b"),t=n.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(o,e,(function(){return r[e]}))}(i);o["default"]=t.a},f9a6:function(e,o,n){"use strict";n.r(o);var r=n("47d8"),t=n("ed3f");for(var i in t)["default"].indexOf(i)<0&&function(e){n.d(o,e,(function(){return t[e]}))}(i);n("e927");var a=n("828b"),l=Object(a["a"])(t["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],void 0);o["default"]=l.exports}},[["b7fe","common/runtime","common/vendor"]]]);
(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"0843":function(n,e,o){"use strict";(function(n,e){var t=o("47a9");o("d3e5");t(o("3240"));var i=t(o("4c82"));n.__webpack_require_UNI_MP_PLUGIN__=o,e(i.default)}).call(this,o("3223")["default"],o("df3c")["createPage"])},"2f86":function(n,e,o){"use strict";(function(n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={data:function(){return{SessionKey:"",phoneNumber:"",OpenId:"",nickName:null,avatarUrl:"/static/sign/logo_sign.png",show:!0,number:!1,sureShow:!1}},onLoad:function(){this.sign()},methods:{getInfoBtn:function(){n.$u.throttle(this.getInfo,1e3)},getInfo:function(){var e=this;n.showLoading({title:"加载中"}),setTimeout((function(){n.hideLoading()}),300),n.getUserProfile({desc:"获取个人信息",success:function(o){n.hideLoading(),e.avatarUrl=o.userInfo.avatarUrl,n.setStorageSync("nickName",o.userInfo.nickName),n.setStorageSync("avatarUrl",o.userInfo.avatarUrl),e.show=!1,e.number=!0}})},getPhoneNumber:function(e){var o=this;console.log(e),this.$u.post("/login/getWxPhone",{encryptedData:e.detail.encryptedData,session_key:n.getStorageSync("session_key"),iv:e.detail.iv}).then((function(e){console.log(e.error),0==e.error?(o.show=!1,o.phoneNumber=e.data.purePhoneNumber,n.setStorageSync("phoneNumber",e.data.purePhoneNumber),o.doBind(),o.$u.post("/login/userBind",{mobile:o.phoneNumber,face:n.getStorageSync("avatarUrl"),nickname:n.getStorageSync("nickName"),wx_openid:n.getStorageSync("wx_openid"),invite:n.getStorageSync("uid_key")}).then((function(e){0==e.error?(n.setStorageSync("is_bind",1),o.sureShow=!0):o.loginFalse()}))):n.showToast({title:e.msg,icon:"none"})}))},confirm:function(){n.switchTab({url:"../index/index"})},back:function(){n.switchTab({url:"../index/index"})},douyinLogin:function(){var e=this;tt.login({force:!0,success:function(o){e.$u.post("/login/dylogin",{code:o.code}).then((function(o){console.log(o.error),0==o.error&&(n.setStorageSync("token",o.data.token),n.setStorageSync("session_key",o.data.session_key),n.setStorageSync("is_bind",o.data.is_bind),n.setStorageSync("wx_openid",o.data.wx_openid),n.getUserInfo({withCredentials:!0,success:function(t){n.setStorageSync("avatarUrl",t.userInfo.avatarUrl),e.$u.post("/login/userBind",{mobile:"18888888888",face:t.userInfo.avatarUrl,nickname:t.userInfo.nickName,wx_openid:o.data.wx_openid,invite:""}).then((function(n){0==n.error?e.sureShow=!0:e.loginFalse()}))},fail:function(){console.log("getUserInfo 调用失败")}}))}))},fail:function(n){console.log("login 调用失败")}})},sign:function(){var e=this;n.login({provider:"weixin",success:function(o){var t=o.code;console.log(t),e.$u.post("/login/getOpenid",{code:t}).then((function(o){0==o.error?(n.setStorageSync("token",o.data.token),n.setStorageSync("session_key",o.data.session_key),n.setStorageSync("is_bind",o.data.is_bind),n.setStorageSync("wx_openid",o.data.wx_openid),console.log(n.getStorageSync("is_bind")),0===n.getStorageSync("is_bind")?e.show=!0:(e.show=!1,e.number=!1,e.$u.post("/ucenter/getUserInfo").then((function(e){console.log(e),n.setStorageSync("avatarUrl",e.data.face),n.showToast({title:"登录成功",duration:2e3,icon:"success"}),setTimeout((function(){n.switchTab({url:"../index/index"})}),1500)})))):n.showToast({title:o.msg,icon:"none"})}))}})},doBind:function(){if(n.hideKeyboard(),!this.phoneNumber)return n.showToast({title:"获取手机号码失败",icon:"none"}),!1},loginFalse:function(){return n.hideKeyboard(),n.showToast({title:"登录失败",icon:"none"}),!1}}};e.default=o}).call(this,o("df3c")["default"])},"432a":function(n,e,o){},"4c82":function(n,e,o){"use strict";o.r(e);var t=o("6acd"),i=o("a02d");for(var a in i)["default"].indexOf(a)<0&&function(n){o.d(e,n,(function(){return i[n]}))}(a);o("fad8");var r=o("828b"),s=Object(r["a"])(i["default"],t["b"],t["c"],!1,null,null,null,!1,t["a"],void 0);e["default"]=s.exports},"6acd":function(n,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){return t}));var t={uModal:function(){return o.e("uview-ui/components/u-modal/u-modal").then(o.bind(null,"eabe"))}},i=function(){var n=this.$createElement;this._self._c},a=[]},a02d:function(n,e,o){"use strict";o.r(e);var t=o("2f86"),i=o.n(t);for(var a in t)["default"].indexOf(a)<0&&function(n){o.d(e,n,(function(){return t[n]}))}(a);e["default"]=i.a},fad8:function(n,e,o){"use strict";var t=o("432a"),i=o.n(t);i.a}},[["0843","common/runtime","common/vendor"]]]);
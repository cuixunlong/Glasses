(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/detail"],{"0699":function(e,t,i){},"17ba":function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return s}));var s={uModal:function(){return i.e("uview-ui/components/u-modal/u-modal").then(i.bind(null,"e656"))},uToast:function(){return i.e("uview-ui/components/u-toast/u-toast").then(i.bind(null,"f667"))},uParse:function(){return Promise.all([i.e("common/vendor"),i.e("uview-ui/components/u-parse/u-parse")]).then(i.bind(null,"f596"))},uPopup:function(){return i.e("uview-ui/components/u-popup/u-popup").then(i.bind(null,"1884"))},uSelect:function(){return i.e("uview-ui/components/u-select/u-select").then(i.bind(null,"9625"))},uInput:function(){return Promise.all([i.e("common/vendor"),i.e("uview-ui/components/u-input/u-input")]).then(i.bind(null,"bcfd"))}},o=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.show=!0},e.e1=function(t){e.show=!1})},a=[]},"23e5":function(e,t,i){"use strict";i.r(t);var s=i("f022"),o=i.n(s);for(var a in s)"default"!==a&&function(e){i.d(t,e,(function(){return s[e]}))}(a);t["default"]=o.a},"54b2":function(e,t,i){"use strict";(function(e,t){i("c264");o(i("66fd"));var s=o(i("8bc3"));function o(e){return e&&e.__esModule?e:{default:e}}e.__webpack_require_UNI_MP_PLUGIN__=i,t(s.default)}).call(this,i("f266")["default"],i("f266")["createPage"])},"883a":function(e,t,i){"use strict";var s=i("0699"),o=i.n(s);o.a},"8bc3":function(e,t,i){"use strict";i.r(t);var s=i("17ba"),o=i("23e5");for(var a in o)"default"!==a&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("883a");var n,r=i("f0c5"),l=Object(r["a"])(o["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],n);t["default"]=l.exports},f022:function(e,t,i){"use strict";(function(e,i){function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){var e;return e={swiperHeight:"",sureShow:!1,show:!1,partsShow:!1,candleNum:"",platePrice:0,changePlate:"",plate:"",plateNum:"",plateNumber:"",plateIndex:0,plateShow:!1,plateList:[],flavorIndex:0,flavorPrice:"",flavorName:"",sizeIndex:0,sizePrice:"",sizeName:"",partsIndex:0,partsPrice:"",partsName:"",navBarHeight:0,blessing:"",swiper:["../../static/details/top_food.png","../../static/details/top_food.png","../../static/details/top_food.png","../../static/details/top_food.png","../../static/details/top_food.png"],sizeList:[],partsList:[],flavorList:[],goodsDetail:[]},s(e,"plateList",[]),s(e,"list",[]),s(e,"defalt",[0]),s(e,"from",{}),s(e,"swiperList",[]),s(e,"number",""),s(e,"stock",""),e},onLoad:function(t){var s=this;this.stock=t.stock,console.log(this.stock);var o=this,a=e.getSystemInfoSync();o.swiperHeight=a.screenWidth;var n=e.getMenuButtonBoundingClientRect();o.navBarHeight=2*(n.top-a.statusBarHeight)+a.statusBarHeight;for(var r=1;r<=100;r++){var l={};l.value=r,l.label=r+"岁",this.list.push(l)}this.$u.post("/index/getGoodsDetail",{goods_id:t.goods_id}).then((function(e){0==e.error?(console.log(e.data),s.from.goods_id=e.data.goods_id,s.from.goods_sku_id=e.data.sku[s.partsIndex].id,s.from.candle_select=e.data.candle_select[s.partsIndex].id,s.from.taste_select=e.data.taste_select[s.flavorIndex].id,s.from.tableware_num=e.data.tableware_num,s.goodsDetail=e.data,s.swiperList=e.data.album.split(","),console.log(s.goodsDetail.price),s.flavorList=e.data.taste_select,s.flavorPrice=e.data.taste_select[s.flavorIndex].price,s.flavorName=e.data.taste_select[s.flavorIndex].name,s.partsList=e.data.candle_select,s.partsPrice=e.data.candle_select[s.partsIndex].price,s.partsName=e.data.candle_select[s.partsIndex].name,s.sizeList=e.data.sku,1==s.stock&&(s.sizeIndex=s.sizeList.findIndex((function(e){return e.specs_stock>0}))),s.sizePrice=e.data.sku[s.sizeIndex].specs_price,s.sizeName=e.data.sku[s.sizeIndex].specs_name,s.number=+e.data.tableware_num,s.plate=e.data.tableware_price,s.changePlate=2*+e.data.tableware_price,s.totalPrice()):i.showToast({title:e.msg,icon:"none"});for(var t=1;t<=30;t++){var o={};s.plateNum=s.goodsDetail.tableware_num,s.plate=s.goodsDetail.tableware_price,o.value=t,o.label="餐盘数量"+t*s.plateNum+"个（"+(t*s.plateNum-s.plate)+"元）",s.plateList.push(o)}console.log(s.plateList)}))},methods:{confirm:function(){i.reLaunch({url:"../login/login"}),this.sureShow=!1},cancel:function(){this.sureShow=!1},changeFlavor:function(e,t){console.log(e),this.from.taste_select=e.id,this.flavorPrice=e.price,this.flavorName=e.name,this.totalPrice(),this.flavorIndex=t},chooseSize:function(e,t){1!=this.stock?(this.from.goods_sku_id=t.id,console.log(this.from.goods_sku_id),this.sizePrice=t.specs_price,this.sizeName=t.specs_name,this.totalPrice(),this.sizeIndex=e):0==t.specs_stock?i.showToast({title:"当前门店该尺寸库存已售罄",icon:"none"}):(this.from.goods_sku_id=t.id,this.sizePrice=t.specs_price,this.sizeName=t.specs_name,this.totalPrice(),this.sizeIndex=e)},changeColor:function(e,t){console.log(t),1==t.is_default&&(this.partsShow=!0),this.from.candle_select=t.id,this.partsPrice=t.price,this.partsName=t.name,this.totalPrice(),1==t.candle_num&&(this.partsShow=!0),this.partsIndex=e},changeCandle:function(e){this.defalt=[e[0].label-1],console.log(e),this.from.candle_num=e[0].value,console.log(this.from.candle_num)},cancelCandle:function(){this.candleNum=this.candleNum,console.log(this.candleNum)},choosePlate:function(e){this.plateNumber=e[0].value*this.plateNum,this.from.tableware_num=this.plateNumber;var t=(this.plateNumber-this.plateNum)/this.plateNum*this.plate;this.goodsDetail.price=this.keepFull(+this.goodsDetail.price+t)},value:function(){this.blessing.length>=20?i.showToast({title:"最多输入20个字",duration:2e3,icon:"none"}):this.from.wish_remark=this.blessing},sureBtn:function(){this.$u.throttle(this.sure,1e3)},sure:function(){var e=this;console.log(this.plateNumber),""===i.getStorageSync("token")?this.sureShow=!0:0==i.getStorageSync("is_bind")&&i.clearStorageSync(),""==this.sizePrice?i.showToast({title:"当前门店库存已售罄",icon:"none"}):""==this.blessing?i.showToast({title:"请输入祝福语",icon:"none"}):""==this.plateNumber?(i.showToast({title:"请选择餐盘数量",icon:"none"}),this.plateShow=!this.plateShow):this.$u.post("/order/previewOrder",this.from).then((function(t){0==t.error?(i.setStorageSync("order_key",e.from),i.navigateTo({url:"../order/confirm_order?stock="+e.stock})):"数字蜡烛,需要您选择年龄"==t.msg?(e.partsShow=!0,i.showToast({title:t.msg,icon:"none"})):i.showToast({title:t.msg,icon:"none"})}))},swiperPreview:function(e){i.previewImage({urls:this.swiperList,current:e})},totalPrice:function(){console.log(this.sizePrice),""==this.sizePrice?this.goodsDetail.price=+ +this.flavorPrice+ +this.partsPrice+ +this.platePrice:this.goodsDetail.price=+this.sizePrice+ +this.flavorPrice+ +this.partsPrice+ +this.platePrice,this.goodsDetail.price=this.keepFull(this.goodsDetail.price)},keepFull:function(e){var t=Math.round(100*e)/100,i=t.toString(),s=i.indexOf(".");s<0&&(s=i.length,i+=".");while(i.length<=s+2)i+="0";return i}}};t.default=o}).call(this,i("f266")["default"],i("f266")["default"])}},[["54b2","common/runtime","common/vendor"]]]);